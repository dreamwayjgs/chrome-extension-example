console.log("background running");

// chrome.tabs.onUpdated.addListener(function (tabId, changeInfo, tab) {
//     // alert(changeInfo.url);
//     function __onWindowLoad() {
//         chrome.extension.onMessage.addListener(function (request, sender) {
//             if (request.action == "getSource") {
//                 document.body.innerText = request.source;
//             }
//         });

//         function onWindowLoad() {
//             chrome.tabs.executeScript(null, {
//                 file: "getSource.js"
//             }, function () {
//                 if (chrome.extension.lastError) {
//                     document.body.innerText = 'Error : \n' + chrome.extension.lastError.message;
//                 }
//             });
//         }

//         window.onload = onWindowLoad;
//     }

//     __onWindowLoad();
// });

// //chrome.tabs.onUpdated.addListener(function (tabId, changeInfo, tab) {
// chrome.runtime.onInstalled.addListener(async () => {
//     //code in here will run every time a user goes onto a new tab, so you can insert your scripts into every new tab
//     chrome.extension.onMessage.addListener(function (request, sender) {
//         if (request.action == "getSource") {
//             document.body.innerText = request.source;
//         }
//     });

//     function onWindowLoad() {
//         chrome.tabs.executeScript(null, {
//             file: "getSource.js"
//         }, function () {
//             if (chrome.extension.lastError) {
//                 document.body.innerText = 'Error : \n' + chrome.extension.lastError.message;
//             }
//         });
//     }

//     window.onload = onWindowLoad;
// });

function __onWindowLoad() {
    chrome.runtime.onMessage.addListener(function (request, sender) {
        if (request.action == "getSource") {
            document.body.innerText = request.source;
        }
        console.log("1");
    });

    function onWindowLoad() {
        console.log("2");
        chrome.tabs.executeScript(null, {
            file: "getSource.js"
        }, function () {
            if (chrome.runtime.lastError) {
                document.body.innerText = 'Error : \n' + chrome.runtime.lastError.message;
                console.log("14");
            }
        });
        console.log("13");
    }

    window.onload = onWindowLoad;
}

__onWindowLoad();

// /* global chrome */